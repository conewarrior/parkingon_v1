<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>새 비밀번호 설정 - 파킹온 아파트너</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" th:href="@{/css/app.css}">
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <script th:src="@{/js/common.js}"></script>
</head>
<body class="login-page">
    <div class="login-container">
        <!-- 로고 섹션 -->
        <div class="logo-section">
            <img th:src="@{/images/parkingon-logo.png}" alt="ParkingOn Logo" class="login-logo">
        </div>

        <!-- 비밀번호 재설정 카드 -->
        <div class="login-card">
            <h2 class="login-title">새 비밀번호 설정</h2>
            <p style="text-align: center; color: #666; margin-bottom: 8px; font-size: 14px;">
                사용자: <strong th:text="${username}">username</strong>
            </p>
            <p style="text-align: center; color: #666; margin-bottom: 24px; font-size: 13px;">
                새로운 비밀번호를 입력해주세요.
            </p>

            <!-- 에러 메시지 -->
            <div th:if="${error}" class="error-message" style="background-color: #fee; color: #c33; padding: 12px; border-radius: 4px; margin-bottom: 16px; text-align: center;">
                <span th:text="${message}">오류가 발생했습니다.</span>
            </div>

            <form th:action="@{/password-reset/reset}" method="post" class="login-form" id="resetForm">
                <input type="hidden" name="token" th:value="${token}">

                <!-- 새 비밀번호 입력 -->
                <div class="form-group">
                    <label for="newPassword" style="display: block; margin-bottom: 8px; color: #333; font-size: 14px; font-weight: 500;">
                        새 비밀번호
                    </label>
                    <input
                        type="password"
                        name="newPassword"
                        id="newPassword"
                        class="form-input"
                        placeholder="새 비밀번호 (최소 8자)"
                        minlength="8"
                        required
                        autofocus>
                    <span class="error-message" id="password-error" style="display: none;">
                        비밀번호는 최소 8자 이상이어야 합니다.
                    </span>
                </div>

                <!-- 비밀번호 확인 -->
                <div class="form-group">
                    <label for="confirmPassword" style="display: block; margin-bottom: 8px; color: #333; font-size: 14px; font-weight: 500;">
                        비밀번호 확인
                    </label>
                    <input
                        type="password"
                        name="confirmPassword"
                        id="confirmPassword"
                        class="form-input"
                        placeholder="비밀번호 확인"
                        minlength="8"
                        required>
                    <span class="error-message" id="confirm-error" style="display: none;">
                        비밀번호가 일치하지 않습니다.
                    </span>
                </div>

                <!-- 재설정 버튼 -->
                <button type="submit" class="btn-login">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
                        <path d="M12 1v6m0 6v6m6-9l-6 6-6-6"></path>
                        <circle cx="12" cy="12" r="10"></circle>
                    </svg>
                    비밀번호 재설정
                </button>

                <!-- 로그인 페이지로 돌아가기 -->
                <div class="login-footer">
                    <a th:href="@{/login}" class="change-password-link">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 4px;">
                            <line x1="19" y1="12" x2="5" y2="12"></line>
                            <polyline points="12 19 5 12 12 5"></polyline>
                        </svg>
                        로그인으로 돌아가기
                    </a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // 비밀번호 확인 검증
        document.getElementById('resetForm').addEventListener('submit', function(e) {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const passwordError = document.getElementById('password-error');
            const confirmError = document.getElementById('confirm-error');

            // 에러 메시지 초기화
            passwordError.style.display = 'none';
            confirmError.style.display = 'none';

            // 비밀번호 길이 검증
            if (newPassword.length < 8) {
                e.preventDefault();
                passwordError.style.display = 'block';
                return false;
            }

            // 비밀번호 일치 검증
            if (newPassword !== confirmPassword) {
                e.preventDefault();
                confirmError.style.display = 'block';
                return false;
            }

            return true;
        });

        // 실시간 비밀번호 일치 확인
        document.getElementById('confirmPassword').addEventListener('input', function() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = this.value;
            const confirmError = document.getElementById('confirm-error');

            if (confirmPassword.length > 0 && newPassword !== confirmPassword) {
                confirmError.style.display = 'block';
            } else {
                confirmError.style.display = 'none';
            }
        });
    </script>
</body>
</html>
