# 대시보드 (근무자용) - UX 흐름 및 인터랙션 가이드

## 문서 개요
- **페이지명**: 대시보드 (근무자용)
- **사용자**: 상담원 (Operator)
- **목적**: 실시간 차량 입차 요청에 대한 상담 및 차단기 제어
- **핵심 시나리오**: 차량이 입구에 도착 → 상담원이 확인 → 입차 허가/불허 결정

---

## 1. 페이지 전체 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                         Header (공통)                            │
├─────────────┬───────────────────────────┬─────────────────────┤
│             │                           │                     │
│   좌측:     │      중앙:               │     우측:          │
│  아파트     │    메인 패널             │   컨트롤 패널      │
│  목록       │                           │                     │
│  사이드바   │  - 상태 표시줄           │  - 차량번호 표시   │
│             │  - CCTV 영상             │  - 이전 상담내역   │
│             │  - 입차 이미지           │  - 상담 정보 입력  │
│             │                           │  - 차단기 제어     │
│             │                           │                     │
├─────────────┴───────────────────────────┴─────────────────────┤
│                    하단 상태 바                                  │
├──────────────────────────────────────────────────────────────────┤
│                      PBX 바                                      │
└──────────────────────────────────────────────────────────────────┘
```

---

## 2. 핵심 사용 시나리오

### 시나리오 A: 정상적인 입차 처리 흐름

#### Step 1: 차량 도착 감지
**트리거**: 차량이 아파트 입구 LPR 장비 앞에 도착

**시스템 동작**:
1. LPR 장비가 차량번호 자동 인식 (예: "12가1234")
2. 입차 이미지 자동 촬영
3. CCTV 화면 실시간 스트리밍 시작

**화면 변화**:
- **우측 컨트롤 패널**:
  - 차량번호 표시 영역에 큰 글씨로 "12가1234" 표시
  - 상담 정보 입력 폼의 "차량번호" 필드에 자동 입력
  - 단지명, 일시 자동 설정 (읽기 전용)

- **중앙 메인 패널**:
  - 입차 이미지 영역에 촬영된 차량 사진 표시
  - CCTV 영역에 실시간 영상 표시

**사용자 인지**:
- 차량번호가 크게 표시되어 즉시 확인 가능
- 시각적으로 차량 이미지를 통해 실제 차량 확인

---

#### Step 2: 차량 정보 확인 및 이전 상담내역 조회
**사용자 행동**: 상담원이 화면을 보며 상황 파악

**시스템 동작**:
1. 차량번호로 DB 조회
2. 해당 차량의 이전 상담내역 자동 로드

**화면 변화**:
- **우측 컨트롤 패널 - 이전 상담내역**:
  - 최근 2건의 상담 이력 표시
  - 예시:
    ```
    10-14 21:20:21
    102동 1004호...

    10-10 19:15:30
    방문고객, 배달...
    ```

**사용자 판단**:
- 이전 방문 이력을 통해 "단골 방문 차량인지" 판단
- 특이사항이 있었는지 확인

---

#### Step 3: 상담 정보 입력
**사용자 행동**: 상담원이 폼 작성

**입력 필드별 동작**:

1. **단지명** (자동 설정, 읽기 전용)
   - 좌측 사이드바에서 선택된 아파트 자동 반영
   - 예: "아파트1 단지A"

2. **일시** (자동 설정, 읽기 전용)
   - 차량 도착 시간 자동 기록
   - 형식: YYYY-MM-DD HH:mm:ss

3. **차량번호** (자동 입력, 수정 가능)
   - LPR 인식 결과 자동 입력
   - 인식 오류 시 상담원이 수동 수정 가능

4. **고객유형** (드롭다운 선택)
   - 옵션: 방문고객, 입주민, 출역
   - **선택 기준**:
     - **입주민**: 해당 아파트 거주자
     - **방문고객**: 일반 방문자
     - **출역**: 퇴근/외출 중인 차량

5. **방문목적** (드롭다운 선택)
   - 옵션: 방문, 배달, 택배
   - **선택 기준**:
     - 상담원이 인터폰 또는 육성으로 문의
     - "어디 방문하셨나요?" → 답변에 따라 선택

6. **동/호** (2개 드롭다운)
   - 첫 번째: 동 선택 (101, 102, 103...)
   - 두 번째: 호 선택 (1002, 1003, 1004...)
   - **입력 방법**:
     - 방문객에게 "몇 동 몇 호 방문하시나요?" 질문
     - 답변 받아 선택

7. **상담내역** (textarea)
   - 자유 텍스트 입력
   - 예시: "102동 1004호 방문, 정기 배달 업체"

**UX 흐름**:
```
차량번호 자동 인식
    ↓
고객유형 선택 (상담원 판단)
    ↓
방문목적 확인 (질문 후 선택)
    ↓
동/호 확인 (질문 후 선택)
    ↓
상담내역 작성 (특이사항 기록)
```

---

#### Step 4: 차단기 제어 결정
**사용자 행동**: 입차 허가 여부 결정

**판단 기준**:
1. **자동 입차 허가 대상**:
   - 입주민 (화이트 리스트)
   - 정기 방문 차량
   - 사전 등록된 배달 차량

2. **확인 후 입차 허가**:
   - 방문 목적 확인됨
   - 방문할 동/호 확인됨
   - 특이사항 없음

3. **입차 불허**:
   - 블랙 리스트 차량
   - 방문 목적 불분명
   - 거주자가 방문 거부

**차단기 제어 UI**:
- **라디오 버튼**:
  - ◯ 열림 (입차 허가)
  - ● 닫힘 (입차 불허, 기본값)

- **차단기 제어 버튼**:
  - 라디오 버튼 선택 후 클릭
  - 클릭 시 API 호출하여 실제 차단기 제어

**인터랙션 흐름**:
```
상담 완료
    ↓
입차 허가 결정
    ↓
"열림" 라디오 선택
    ↓
"차단기 제어" 버튼 클릭
    ↓
차단기 열림 (물리적 동작)
    ↓
차량 입차
    ↓
자동으로 차단기 닫힘
```

---

#### Step 5: 상담 내역 저장
**시스템 동작**:
1. 차단기 제어 후 자동으로 상담 내역 DB 저장
2. 저장 내용:
   - 차량번호
   - 고객유형
   - 방문목적
   - 동/호
   - 상담내역 텍스트
   - 상담 일시
   - 상담원 정보
   - 차단기 제어 이력

**다음 차량 대기**:
- 폼 자동 초기화
- CCTV 화면은 계속 스트리밍
- 다음 차량 대기 상태

---

### 시나리오 B: 블랙 리스트 차량 처리

#### Step 1: 차량 도착 및 자동 인식
- 차량번호 인식: "45나5678"

#### Step 2: 시스템 자동 조회
**시스템 동작**:
1. DB에서 차량번호 조회
2. 블랙 리스트로 등록된 차량 발견

**화면 변화**:
- **하단 상태 바**:
  - "방문차단이력" 칩이 빨간색으로 변경
  - 텍스트: "방문차단이력: 경고"

- **우측 컨트롤 패널 - 이전 상담내역**:
  - 차단 이력 표시
  - 예시: "블랙 리스트 차량, 입차 금지"

**알림**:
- 시각적 경고 (빨간색 테두리 또는 배경)
- 청각 알림 (선택사항)

#### Step 3: 상담원 대응
**행동**:
1. 인터폰으로 차량과 통화
2. 입차 불가 사유 안내
3. "닫힘" 상태 유지
4. 상담내역에 상황 기록

**차단기 제어**:
- "닫힘" 라디오 버튼 선택 (기본값 유지)
- "차단기 제어" 버튼 클릭 (닫힘 상태 유지 확인)

---

### 시나리오 C: LPR 인식 실패 처리

#### Step 1: 차량 도착, 번호판 인식 실패
**원인**:
- 번호판 오염
- 각도 문제
- 조명 불량

**시스템 동작**:
- 차량번호 필드: 공백 또는 "인식 실패"

#### Step 2: 상담원 개입
**행동**:
1. CCTV 화면으로 차량번호 육안 확인
2. 차량번호 필드에 수동 입력
3. 나머지 상담 절차 진행

**UX 포인트**:
- 차량번호 필드는 수정 가능하므로 유연하게 대응

---

## 3. 좌측 사이드바: 아파트 선택 인터랙션

### 목적
- 상담원이 담당하는 여러 아파트 중 현재 처리할 아파트 선택

### 인터랙션 흐름

#### 초기 상태
- 첫 번째 아파트 자동 선택 (체크박스 체크됨)
- 해당 아파트의 LPR 장비와 연결

#### 아파트 변경
**사용자 행동**: 다른 아파트 행 클릭 또는 체크박스 선택

**시스템 동작**:
1. 선택된 아파트 강조 표시 (배경색 변경)
2. CCTV 스트리밍 변경 (해당 아파트의 CCTV로 전환)
3. 상담 정보 폼의 "단지명" 자동 변경
4. 해당 아파트의 차량 입차 이벤트만 수신

**시각적 피드백**:
- 선택된 행: 파란색 배경
- 선택되지 않은 행: 흰색 배경
- 호버 시: 연한 회색 배경

### 검색 기능
**사용자 행동**: 검색창에 아파트명 입력 후 "조회" 클릭

**시스템 동작**:
1. 입력된 텍스트로 아파트 목록 필터링
2. 일치하는 아파트만 테이블에 표시
3. 검색 결과 없으면: "검색 결과가 없습니다" 메시지

**UX 포인트**:
- 상담원이 많은 아파트를 담당할 때 빠른 선택 가능

---

## 4. 중앙 메인 패널: 실시간 모니터링

### 4.1 상단 상태 표시줄

#### 표시 항목 및 의미

1. **차단기**
   - 정상: 초록색, "정상"
   - 점검: 노란색, "점검"
   - 오류: 빨간색, "오류"
   - **의미**: 차단기 하드웨어 상태

2. **시스템**
   - 정상: 초록색, "정상"
   - 점검: 노란색, "점검"
   - **의미**: 전체 시스템 상태

3. **CPU**
   - 표시: "30%", "50%", "80%"
   - 70% 이상: 노란색 경고
   - **의미**: 서버 CPU 사용률

4. **메모리**
   - 표시: "40%", "60%", "90%"
   - 80% 이상: 노란색 경고
   - **의미**: 서버 메모리 사용률

5. **통신**
   - 표시: "20M", "50M"
   - **의미**: 네트워크 전송 속도

6. **저장소**
   - 표시: "50/100" (50GB / 100GB)
   - **의미**: 디스크 사용량

#### UX 목적
- 상담원이 시스템 이상 감지 시 즉시 인지
- 차단기 오류 시 수동 대응 필요 알림

---

### 4.2 CCTV 영역

#### 기능
- 실시간 CCTV 스트리밍
- 입구 상황 모니터링

#### 인터랙션
- **기본**: 자동 재생
- **확대 보기** (선택사항): 클릭 시 전체 화면
- **새로고침** (선택사항): 스트리밍 끊김 시 재연결

#### UX 가치
- 차량번호 육안 확인
- 차량 외관 확인 (사고 차량, 손상 차량 등)
- 운전자 행동 관찰

---

### 4.3 입차 이미지 영역

#### 기능
- 차량 입차 시 자동 촬영된 정지 이미지 표시

#### 활용
- 상담 내역 증빙 자료
- 차량번호 재확인
- 나중에 이력 조회 시 참조

#### UX 포인트
- CCTV는 동영상, 입차 이미지는 정지 화면
- 둘 다 제공하여 상황 파악 용이

---

## 5. 우측 컨트롤 패널: 상담 처리

### 5.1 차량번호 표시

#### 디자인
- 큰 글씨 (32px 이상)
- 굵은 폰트
- 배경: 어두운 색
- 글자: 흰색 또는 노란색

#### UX 목적
- 한눈에 현재 처리 중인 차량번호 인지
- 잘못된 차량에 대한 처리 방지

---

### 5.2 이전 상담내역

#### 표시 내용
- 최근 2건
- 각 건당:
  - 상담 일시 (MM-DD HH:mm:ss)
  - 상담 내용 요약 (첫 20자 + "...")

#### UX 가치
- 단골 방문객 빠른 처리
- 문제 차량 사전 인지
- 상담 일관성 유지

#### 인터랙션
- **클릭 시** (선택사항): 상세 내역 팝업 표시

---

### 5.3 상담 정보 입력 폼

#### 폼 배치 순서 (위→아래)
1. 단지명 (읽기 전용)
2. 일시 (읽기 전용)
3. 차량번호 (수정 가능)
4. 고객유형 (드롭다운)
5. 방문목적 (드롭다운)
6. 동/호 (2개 드롭다운)
7. 상담내역 (textarea)

#### 입력 흐름 (Tab 순서)
```
차량번호 확인
    ↓ (Tab)
고객유형 선택
    ↓ (Tab)
방문목적 선택
    ↓ (Tab)
동 선택
    ↓ (Tab)
호 선택
    ↓ (Tab)
상담내역 작성
    ↓ (Tab)
차단기 제어
```

#### 키보드 단축키 (선택사항)
- **Enter**: 다음 필드로 이동
- **Ctrl+S**: 저장
- **Ctrl+O**: 차단기 열림
- **Ctrl+C**: 차단기 닫힘

---

### 5.4 차단기 제어

#### UI 구성
1. **라디오 버튼 그룹**:
   - ◯ 열림
   - ● 닫힘 (기본값)

2. **차단기 제어 버튼**:
   - 텍스트: "차단기 제어"
   - 색상: 파란색 (강조)
   - 크기: 큼 (전체 너비)

#### 동작 흐름
```
[사용자] 라디오 버튼 선택 ("열림" 또는 "닫힘")
    ↓
[사용자] "차단기 제어" 버튼 클릭
    ↓
[시스템] 선택된 상태 확인
    ↓
[시스템] API 호출 → 차단기 하드웨어 제어
    ↓
[시스템] 상담 내역 자동 저장
    ↓
[시스템] 성공 메시지 표시
    ↓
[시스템] 폼 초기화 (다음 차량 대기)
```

#### 에러 처리
- **통신 오류**: "차단기 제어 실패. 다시 시도해주세요."
- **하드웨어 오류**: "차단기 응답 없음. 관리자에게 문의하세요."

---

## 6. 하단 상태 바

### 표시 항목

1. **방문차단이력**
   - 정상: 초록 칩, "방문차단이력: 정상"
   - 경고: 빨강 칩, "방문차단이력: 경고"
   - **트리거**: 블랙 리스트 차량 감지

2. **VOC이력**
   - 정상: 초록 칩, "VOC이력: 정상"
   - 경고: 노랑 칩, "VOC이력: 주의"
   - **트리거**: 최근 민원 이력 있는 차량

3. **수동제어**
   - 정상: 초록 칩, "수동제어: 정상"
   - 활성: 파랑 칩, "수동제어: 활성"
   - **의미**: 현재 수동 제어 모드 여부

4. **검지차**
   - 정상: 초록 칩, "검지차: 정상"
   - 감지: 노랑 칩, "검지차: 대기 중"
   - **의미**: 차단기 앞 차량 감지 센서 상태

### UX 목적
- 전체 시스템 상태 한눈에 파악
- 이상 상황 즉시 인지

---

## 7. PBX 바

### 기능
- 전화 통화 정보 표시
- 예: "PBX콜: 동아아파트"

### 인터랙션
- 전화 수신 시 자동 표시
- 해당 아파트 자동 선택 (선택사항)

### UX 통합
- 전화 상담과 입차 처리를 동시에 수행
- 상담원이 두 가지 상황을 혼동하지 않도록 명확히 구분

---

## 8. 전체 워크플로우: 종합

### 전형적인 1분간의 업무 흐름

```
00:00 - 대기 중
        ├─ CCTV 모니터링
        ├─ 시스템 상태 확인
        └─ 다음 차량 대기

00:15 - 차량 1 도착 (12가1234)
        ├─ 차량번호 자동 인식
        ├─ 입차 이미지 표시
        ├─ 이전 상담내역 로드
        ├─ 상담원: 정보 입력 (15초)
        ├─ 차단기 "열림" 선택
        ├─ "차단기 제어" 클릭
        └─ 차량 입차

00:30 - 차량 2 도착 (45나5678)
        ├─ 차량번호 자동 인식
        ├─ 블랙 리스트 경고!
        ├─ 상담원: 인터폰 통화
        ├─ 입차 불허 안내
        ├─ 차단기 "닫힘" 유지
        └─ 상담내역 기록 후 저장

00:45 - PBX 전화 수신
        ├─ "PBX콜: 동아아파트" 표시
        ├─ 상담원: 전화 응대
        └─ 전화 상담 처리

01:00 - 차량 3 도착 (78다9012)
        └─ 사이클 반복
```

---

## 9. 주요 UX 원칙

### 9.1 효율성
- 자동 입력으로 타이핑 최소화
- Tab 키로 빠른 필드 이동
- 기본값 설정으로 클릭 최소화

### 9.2 명확성
- 차량번호 크게 표시
- 색상 코딩 (초록=정상, 노랑=경고, 빨강=오류)
- 실시간 피드백 (버튼 클릭 시 즉시 반응)

### 9.3 안정성
- 읽기 전용 필드로 실수 방지
- 중요 동작(차단기 제어)은 명시적 버튼 클릭 필요
- 에러 발생 시 명확한 메시지

### 9.4 실시간성
- CCTV 실시간 스트리밍
- 상태 표시 실시간 갱신
- 차량 감지 즉시 알림

---

## 10. 에지 케이스 처리

### 케이스 1: 동시 다발 입차 요청
**상황**: 여러 아파트에서 동시에 차량 도착

**처리**:
- 대기 큐 시스템
- 먼저 도착한 차량부터 처리
- 대기 중인 차량 수 표시 (선택사항)

### 케이스 2: 차단기 고장
**상황**: 차단기 제어 불가

**처리**:
- 상단 상태 표시줄에 "차단기: 오류" 표시
- 상담원에게 알림
- 수동 차단기 개폐 안내 (경비실 연락 등)

### 케이스 3: 통신 두절
**상황**: LPR 장비와 통신 끊김

**처리**:
- "통신" 상태에 빨간색 표시
- CCTV 화면 "연결 끊김" 메시지
- 자동 재연결 시도
- 수동 처리 모드로 전환 (육안 확인)

### 케이스 4: 인터폰 통화 중 다른 차량 도착
**상황**: 전화 상담 중 새로운 차량 입차 요청

**처리**:
- PBX 바에 통화 정보 유지
- 새로운 차량 정보는 우측 패널에 표시
- 전화 끊은 후 차량 처리
- 또는 차량에게 잠시 대기 요청

---

## 11. 접근성 및 사용성

### 키보드 네비게이션
- 모든 기능 키보드로 접근 가능
- Tab 순서 논리적 흐름

### 시각적 피드백
- 버튼 호버 시 색상 변화
- 클릭 시 애니메이션
- 로딩 중 스피너 표시

### 청각 알림 (선택사항)
- 차량 도착 시 "띵" 소리
- 블랙 리스트 차량 시 경고음
- 차단기 제어 성공 시 확인음

---

## 12. 성능 고려사항

### 실시간 데이터 갱신
- **WebSocket** 또는 **Server-Sent Events** 사용
- 차량 감지 이벤트 실시간 수신
- 상태 표시 실시간 업데이트

### CCTV 스트리밍
- **HLS** 또는 **WebRTC** 프로토콜
- 저지연 스트리밍 (<1초)
- 대역폭 최적화

### 이미지 로딩
- 입차 이미지 압축 (JPEG, 품질 80%)
- Lazy loading (필요 시에만 로드)

---

## 13. 모바일 대응 (선택사항)

### 반응형 레이아웃
- 데스크톱: 3단 레이아웃 (좌-중-우)
- 태블릿: 2단 레이아웃 (좌측 접기 가능, 중+우)
- 모바일: 1단 레이아웃 (탭 전환)

### 터치 인터랙션
- 큰 버튼 (최소 44px)
- 스와이프 제스처 (이전/다음 상담내역)

---

## 14. 실전 사용 팁

### 신입 상담원을 위한 가이드
1. **첫 접속**: 좌측에서 담당 아파트 선택
2. **대기**: CCTV 화면 주시
3. **차량 도착**: 차량번호 자동 인식 확인
4. **상담**:
   - 인터폰으로 "어디 방문하셨나요?" 질문
   - 답변 듣고 고객유형, 방문목적, 동/호 입력
5. **허가**: "열림" 선택 → "차단기 제어" 클릭
6. **기록**: 특이사항 있으면 상담내역에 메모
7. **다음**: 자동으로 다음 차량 대기

### 숙련 상담원을 위한 효율화
- 단골 차량은 이전 상담내역 참고하여 빠른 처리
- 키보드 단축키 활용
- 여러 아파트 동시 모니터링 (멀티 모니터 환경)

---

**문서 버전**: 1.0
**최종 수정일**: 2025년
**작성자**: 파킹온 UX팀
